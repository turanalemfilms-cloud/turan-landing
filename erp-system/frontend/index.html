<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMPIRE OS v3.0 | Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #030304; --card: rgba(15, 15, 18, 0.8); --accent: #00d4aa; }
        body { background-color: var(--bg); color: white; font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass { background: var(--card); backdrop-filter: blur(40px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .agent-card:hover { border-color: var(--accent); transform: translateY(-2px); }
        .neon-text { text-shadow: 0 0 10px rgba(0, 212, 170, 0.5); }
    </style>
</head>
<body class="h-screen flex overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-72 glass border-r border-white/5 flex flex-col p-8 space-y-10">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-[#00d4aa] rounded-full flex items-center justify-center text-black font-bold">üê∫</div>
            <div>
                <div class="text-xl font-black tracking-tighter uppercase leading-none">Empire OS</div>
                <div class="text-[10px] text-gray-500 font-bold tracking-widest uppercase">Take's Domain</div>
            </div>
        </div>

        <nav class="flex-1 space-y-4">
            <div class="text-[10px] text-gray-600 uppercase tracking-widest font-bold">Strategic Control</div>
            <button class="w-full text-left p-3 rounded-2xl bg-[#00d4aa]/10 text-[#00d4aa] font-bold transition-all">üõ∞Ô∏è Master View</button>
            <button class="w-full text-left p-3 rounded-2xl text-gray-400 hover:bg-white/5 transition-all">üí∞ Financial Engine</button>
            <button class="w-full text-left p-3 rounded-2xl text-gray-400 hover:bg-white/5 transition-all">üß© Logic Flows</button>
        </nav>

        <div class="p-6 glass rounded-[24px] border-emerald-500/20">
            <div class="text-[10px] text-gray-500 uppercase mb-2">Emperor</div>
            <div class="font-bold text-sm">Turan (Take)</div>
            <div class="text-xs text-[#00d4aa] mt-1">Status: Authorizing</div>
        </div>
    </aside>

    <!-- Main -->
    <main class="flex-1 overflow-y-auto p-12 relative">
        <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-[#00d4aa]/5 rounded-full blur-[150px] -z-10"></div>

        <header class="flex justify-between items-start mb-12">
            <div>
                <h1 class="text-4xl font-extrabold tracking-tight mb-2">Command <span class="text-[#00d4aa]">Orchestrator</span></h1>
                <p class="text-gray-500 font-medium">Unified management for D OS and Autonomous Agent Squad.</p>
            </div>
            <div class="flex space-x-4">
                <div class="glass px-6 py-3 rounded-2xl text-center">
                    <div class="text-[10px] text-gray-500 uppercase font-bold">Core Efficiency</div>
                    <div class="text-xl font-bold accent">98.2%</div>
                </div>
            </div>
        </header>

        <!-- Agents Grid -->
        <div class="mb-12">
            <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-6">Active Agent Squad</h2>
            <div id="agents-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Dynamic Content -->
            </div>
        </div>

        <!-- Task Pipeline -->
        <div class="glass rounded-[40px] p-10">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-xl font-bold uppercase tracking-tight">Intelligence Stream & Tasks</h2>
                <div class="flex space-x-2">
                    <button class="px-4 py-2 bg-white/5 hover:bg-white/10 rounded-xl text-xs font-bold transition-all">PAUSE ALL</button>
                    <button class="px-4 py-2 bg-[#00d4aa] text-black rounded-xl text-xs font-bold transition-all">NEW INTEL</button>
                </div>
            </div>
            <div id="task-list" class="space-y-4">
                <!-- Dynamic Content -->
            </div>
        </div>
    </main>

    <script>
        const ws = new WebSocket('ws://localhost:8003/ws');
        
        async function fetchState() {
            const res = await fetch('http://localhost:8003/api/state');
            const data = await res.json();
            renderAgents(data.agents);
            renderTasks(data.global_tasks);
        }

        function renderAgents(agents) {
            const grid = document.getElementById('agents-grid');
            grid.innerHTML = Object.entries(agents).map(([id, info]) => `
                <div class="glass p-6 rounded-[32px] border-white/5 transition-all agent-card">
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-8 h-8 bg-white/5 rounded-lg flex items-center justify-center text-lg">ü§ñ</div>
                        <span class="text-[10px] ${info.status === 'Active' ? 'text-emerald-400 bg-emerald-400/10' : 'text-gray-500 bg-white/5'} px-2 py-1 rounded-md font-black uppercase tracking-tighter">${info.status}</span>
                    </div>
                    <div class="font-bold text-lg mb-1">${id}</div>
                    <div class="text-[10px] text-gray-500 font-medium mb-4">${info.skills.join(' ‚Ä¢ ')}</div>
                    <button class="w-full py-2 bg-white/5 hover:bg-[#00d4aa] hover:text-black rounded-xl text-[10px] font-bold transition-all uppercase">Open Workspace</button>
                </div>
            `).join('');
        }

        function renderTasks(tasks) {
            const list = document.getElementById('task-list');
            list.innerHTML = tasks.reverse().map(t => `
                <div class="flex items-center justify-between p-4 bg-white/5 rounded-[24px] border border-white/5">
                    <div class="flex items-center space-x-4">
                        <div class="text-xs font-black text-gray-600 mono">${t.id}</div>
                        <div>
                            <div class="font-bold text-sm text-gray-200">${t.title}</div>
                            <div class="text-[10px] text-gray-500">${t.assigned_to} ‚Ä¢ ${new Date(t.timestamp).toLocaleTimeString()}</div>
                        </div>
                    </div>
                    <div class="text-[10px] font-bold px-3 py-1 bg-[#00d4aa]/10 text-[#00d4aa] rounded-full uppercase italic">Processing</div>
                </div>
            `).join('') || '<div class="text-center py-10 text-gray-600 text-sm italic">No active operations...</div>';
        }

        ws.onmessage = () => fetchState();
        fetchState();
        setInterval(fetchState, 5000);
    </script>
</body>
</html>
